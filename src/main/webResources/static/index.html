<!DOCTYPE html>
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">

    <title>首页</title>
    <link href="theme-default.css" rel="stylesheet" type="text/css">
    <link rel="icon" type="image/png" href="favicon.ico">
</head>
<body ng-app="indexApp" ng-controller="indexCtrl">
    <div class="btn-toolbar" role="toolbar">
        <div class="logo"></div>
        <button type="button" class="btn btn-default" onclick="showSomeMessage()">
            <span class="glyphicon glyphicon-plus"></span>
            <span>Show Some Message</span>
        </button>
        <button type="button" class="btn btn-danger" onclick="showAnotherMessage()">
            <span class="glyphicon glyphicon-remove"></span>
            <span>Show Another Message1</span>
        </button>
    </div>
    
    <h3>分步导航</h3>
    <nav>
        <ol class="cd-multi-steps text-center">
            <li class="visited"><a href="#0">购物车</a></li>
            <li class="visited" ><em>结算付款</em></li>
            <li class="visited"><em>送货</em></li>
            <li><em>验货收货</em></li>
        </ol>
    </nav>
    <h3>分布导航angularjs指令版</h3>
    <div step-nav resource-set="resourceSet" current-step="0" enable-step="0" on-show-resource="showResource(resource, index)"></div>

    <h3>分页</h3>
    <nav>
      <ul class="pagination">
        <li>
          <a href="#" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        <li><a href="#">1</a></li>
        <li><a href="#">2</a></li>
        <li><a href="#">3</a></li>
        <li><a href="#">4</a></li>
        <li><a href="#">5</a></li>
        <li>
          <a href="#" aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
      </ul>
    </nav>
</body>
<script src="libs.js" type="text/javascript"></script>
<script src="core.js" type="text/javascript"></script>
<script type="text/javascript">
    angular.module('indexApp', []).controller('indexCtrl', ['$scope', function($scope){
        $scope.resourceSet = [
            {name:'购物车', url:'gwc'},
            {name:'结算付款', url:'jsfc'},
            {name:'送货', url:'sh'},
            {name:'验货收货', url:'yhsh'}
        ];

        $scope.showResource = function (resource, index) {
            console.log(resource)
        }
    }]).directive('stepNav', function(){
        // Runs during compile
        return {
            // priority: 1,
            // terminal: true,
            scope: {
                resourceSet: '=',
                currentStep: '=',
                enableStep: '=',
                onShowResource: '&'
            }, // {} = isolate, true = child, false/undefined = no change
            // controller: function($scope, $element, $attrs, $transclude) {},
            // require: 'ngModel', // Array = multiple requires, ? = optional, ^ = check parent elements
            restrict: 'A', // E = Element, A = Attribute, C = Class, M = Comment
            // template: '',
            templateUrl: 'template/stepNav.tpl.html',
            // replace: true,
            // transclude: true,
            // compile: function(tElement, tAttrs, function transclude(function(scope, cloneLinkingFn){ return function linking(scope, elm, attrs){}})),
            link: function($scope, iElm, iAttrs, controller) {
                console.log($scope.resourceSet, $scope.currentStep, $scope.enableStep);

                // 调用外部方法
                $scope.showResource = function (resource, index) {
                    $scope.currentStep = index;
                    $scope.onShowResource({resource:resource, index:index});
                }

                // 下一步
                $scope.nextStep = function () {
                    var resourceSet = $scope.resourceSet
                    if($scope.currentStep == resourceSet.length - 1) {
                        return;
                    }
                    $scope.currentStep = $scope.currentStep + 1;
                    if($scope.currentStep >= $scope.enableStep) {
                        $scope.enableStep = $scope.currentStep + 1;
                    }
                    $scope.onShowResource({resource:resourceSet[$scope.currentStep], index:$scope.currentStep});
                }

                // 上一步
                $scope.preStep = function () {
                    var resourceSet = $scope.resourceSet
                    if($scope.currentStep == 0) {
                        return;
                    }
                    $scope.currentStep = $scope.currentStep - 1;
                    $scope.onShowResource({resource:resourceSet[$scope.currentStep], index:$scope.currentStep});
                }
            }   
        };
    });
</script>
</html>